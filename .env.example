# MailIt Environment Variables
# Copy to .env and edit before running. All values below are required for production deployment.
# For development, many have sensible defaults.

# ─── PORTS ──────────────────────────────────────────────────────────────
# Expose these ports in your firewall/load balancer
HTTP_PORT=8080                          # MailIt API server (expose to internet if using direct connection)
SMTP_PORT=25                            # SMTP inbound server (expose to internet for bounce/reply handling)
SMTP_SUBMISSION_PORT=587                # SMTP submission port (optional, for client submissions)
WEB_PORT=3000                           # Next.js dashboard web UI

# ─── DATABASE (PostgreSQL) ──────────────────────────────────────────────
POSTGRES_USER=mailit
POSTGRES_PASSWORD=changeme              # CHANGE THIS - use a secure password
POSTGRES_DB=mailit
POSTGRES_HOST=postgres                  # If using Docker Compose, use service name
POSTGRES_PORT=5432

# ─── CACHE (Redis) ──────────────────────────────────────────────────────
REDIS_ADDR=redis:6379                   # If using Docker Compose, use service name
REDIS_PASSWORD=                         # Leave empty if not required; set a strong password in production

# ─── AUTHENTICATION ─────────────────────────────────────────────────────
JWT_SECRET=changeme-generate-a-random-string  # CHANGE THIS - min 32 chars, use a random secure string
BCRYPT_COST=12                          # bcrypt hashing cost (10-14 recommended, default 12)
API_KEY_PREFIX=re_                      # Prefix for generated API keys (Resend-compatible)

# ─── EMAIL DOMAIN & SMTP ────────────────────────────────────────────────
MAILIT_DOMAIN=mail.example.com          # CHANGE THIS - your mail server's FQDN
MAILIT_HOSTNAME=mail.example.com        # CHANGE THIS - same as MAILIT_DOMAIN
CORS_ORIGINS=http://localhost:3000      # CHANGE THIS - comma-separated list of allowed dashboard origins

# ─── DKIM SIGNING ──────────────────────────────────────────────────────
DKIM_SELECTOR=mailit                    # DKIM selector (used in DNS records: selector._domainkey.domain)
DKIM_MASTER_KEY=changeme-32-byte-hex-key  # CHANGE THIS - generate with: openssl rand -hex 16 for 32 bytes (64 chars)
DKIM_KEY_BITS=2048                      # RSA key size (2048 or 4096)

# ─── LOGGING ────────────────────────────────────────────────────────────
LOG_LEVEL=info                          # debug | info | warn | error
LOG_FORMAT=json                         # json | text

# ─── RATE LIMITING ──────────────────────────────────────────────────────
RATE_LIMIT_ENABLED=true                 # Enable rate limiting
RATE_LIMIT_DEFAULT_RPS=10               # Default requests per second
RATE_LIMIT_SEND_RPS=2                   # Requests per second for send endpoint
RATE_LIMIT_BATCH_RPS=1                  # Requests per second for batch endpoint

# ─── STORAGE (Attachments) ──────────────────────────────────────────────
STORAGE_TYPE=local                      # local | s3
STORAGE_LOCAL_PATH=/data/attachments    # Path for local storage (in Docker, typically /data/attachments)

# S3 Storage (only if STORAGE_TYPE=s3)
# STORAGE_S3_BUCKET=
# STORAGE_S3_REGION=
# STORAGE_S3_ENDPOINT=
# STORAGE_S3_ACCESS_KEY=
# STORAGE_S3_SECRET_KEY=

# ─── NEXT.JS DASHBOARD ──────────────────────────────────────────────────
NEXT_PUBLIC_API_URL=http://localhost:8080  # CHANGE THIS - API URL as seen by browser (e.g., https://api.example.com)
NEXTAUTH_SECRET=changeme-generate-a-random-string  # CHANGE THIS - min 32 chars, use a random secure string
NEXTAUTH_URL=http://localhost:3000         # CHANGE THIS - dashboard URL (e.g., https://mail.example.com)
NODE_ENV=production                     # production | development

# ─── WEBHOOK DELIVERY ───────────────────────────────────────────────────
WEBHOOK_SIGNING_ALGORITHM=hmac-sha256   # Algorithm for signing webhook payloads
WEBHOOK_TIMEOUT=30s                     # HTTP timeout for webhook delivery
WEBHOOK_MAX_RETRIES=5                   # Maximum number of delivery attempts

# ─── SUPPRESSION LISTS ──────────────────────────────────────────────────
SUPPRESSION_AUTO_ADD_HARD_BOUNCES=true  # Automatically suppress hard-bounced addresses
SUPPRESSION_AUTO_ADD_COMPLAINTS=true    # Automatically suppress spam complaint addresses

# ─── OPTIONAL: DNS CONFIGURATION ────────────────────────────────────────
# Uncomment to use a custom DNS resolver (e.g., Cloudflare 1.1.1.1)
# DNS_RESOLVER=1.1.1.1:53
# DNS_TIMEOUT=10s
# DNS_CACHE_TTL=5m
